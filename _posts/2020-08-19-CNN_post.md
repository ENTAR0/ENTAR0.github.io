---
title: CNN(Convolutional Neural Network) 정리
categories:
- Deep learning
last_modified_at: 2020-08-29T14:00:00+09:00
tags:
- Deep learning
- Machine learning
- Image Processing

toc: true
---
# 1. Intro
합성곱 신경망(Convolutional Neural Network)을 처음 알게되었을때 합성곱 신경망은 인간이 물체를 식별하는 방식을 모방한 것일까? 아니면 그냥 블랙박스일까?, 학습된 필터는 무엇을 보고있는것일까?, 왜 합성곱 신경망은 전결합층과는 다르게 위치 의존도(reliance of position)에 무관하단것일까? 등등 여러 궁금증이 떠올랐다. 그리고 여러 자료를 찾아본 결과 그 궁금증을 많이 해소 해주는 강의를 찾아 그 강의를 바탕으로 합성곱 신경망에 대해 정리해보고자 작성하였다.  
[Convolutional Neural Networks | MIT 6.S191](https://youtu.be/iaSUYvmCekI)와
[ Understanding Sub-Sampling Layers Within Deep Learning](https://towardsdatascience.com/you-should-understand-sub-sampling-layers-within-deep-learning-b51016acd551), [CNN 개요](https://blog.naver.com/laonple/220587920012), [시각정보 처리과정](https://aidalab.tistory.com/23)을 참고하였다.
# 2. Why CNN?
이미지 처리에 있어서 기존에 있는 전결합층(Fully-Connected-Layer)방식을 사용하지않고 합성곱 신경망 방식을 사용하는것은 합성곱 신경망을 사용함으로써 얻을 수 있는 이득이 상당하기 때문이다.
<p align="center"><img src="https://user-images.githubusercontent.com/56510688/90860659-5efe2d80-e3c5-11ea-8a11-9d2575274a9c.png"></p>
<p align="center">출처:<a href = "https://blog.naver.com/laonple/220587920012">CNN 개요</a></p>
왜냐하면 위에 보이는 이미지 처럼 전결합층의 경우에는 픽셀 하나 하나 뉴런의 입력데이터로 받아 처리한다. 이 경우 모델은 이미지의 Raw data를 학습하기 때문에 위치(Position) 정보에 민감해질 수 밖에 없다. 그래서 이 모델의 입력데이터로 변형된 A의 이미지를 줬을때 A에 대한 정확한 판별을 진행할 수 없다. 하지만 합성곱 신경망의 경우에는 A가 포함된 이미지에서 A에 대한 특징(Feature)들을 뽑아내어서 그 특징들을 바탕으로 판별하기 때문에 변형된 A에 대해 더욱 유연한 처리를 할 수 있게 된다. 한마디로 모델이 공간 정보(Spatial information)을 가진다는 것이다. 또한 전결합층의 경우 16*16 이미지를 처리하는데 28326개의 매개 변수(parameters)가 필요하다. 하지만 일반적인 학습에는 더 큰 해상도의 이미지가 들어가 매개변수 개수가 급격하게 증가해 학습 처리에 많은 부정적인 영향을 준다. 이외에도 많은 이유가 있다. 간단히 살펴보자면 아래와 같은것들이 있다.

- Sharing parameters를 사용해 학습 parameter 개수를 줄일 수 있음
- Spatial Information, 국소성(Locality), 불변성(translation invariance)를 가짐
- Sub-sampling(Pooling)을 사용해 불필요한 세부사항 정보를 제거


# 3. What computers see
이러한 합성곱 신경망 모델에 기반이 되는 필터는 무엇을 보고 있을까? 기본적으로 사람은 왼쪽에 사진을 보고있지만 필터는 오른쪽 이미지처럼 색이 2차원 행렬로 변환된 값들을 보고 있다.
<p align="center"><img src="https://user-images.githubusercontent.com/56510688/91566494-bdf01380-e97e-11ea-9aa2-19884c55cb2f.png"></p>
<p align="center">출처:<a href = "https://towardsdatascience.com/everything-you-ever-wanted-to-know-about-computer-vision-heres-a-look-why-it-s-so-awesome-e8a58dfb641e">Everything You Ever Wanted To Know About Computer Vision</a></p>
그리고 이러한 값들을 기반으로 아래의 과정(Pipeline)을 따라 특징 추출(Feature extraction)을 수행한다.
<p align="center"><img src="https://user-images.githubusercontent.com/56510688/91590175-e6373c80-e995-11ea-9823-613b818b496a.png"></p>
 하지만 이러한 기능을 수행 하면서 객체 간의 스케일이라던지 바라보는 시점, Brightness와 Contrast의 차이, 왜곡등 여러 변수들 때문에 특징 추출을 수행하는데 문제가 생길 수 있다.

# 4. Learning visual features
어떤 방식을 사용해야 여러 변수들에 민감하지 않고 정확한 시각 정보를 컴퓨터에게 학습시킬 수 있을까?
<p align="center"><img src="https://user-images.githubusercontent.com/56510688/92117010-94783180-ee2f-11ea-8383-feafaebbdef9.png"></p>
<p align="center">출처:<a href = "https://www.researchgate.net/figure/The-receptive-field-of-each-convolution-layer-with-a-3-3-kernel-The-green-area-marks_fig4_316950618">Reserach gate</a></p>
이를 이해하기 위해서는 수용 영역 또는 장소야(Receptive Field) 라고 불리는 개념을 이해 해야한다. 수용 영역은 위의 이미지 처럼 한 영역에 대해서 반응하고 다음 레이어에 이를 반영한다. 이는 합성곱으로 표현된다. 또한 이런 과정을 거치면서 수용 영역이 겹칠 수 도 있는데 이를 통해 국소 영역간의 상관 관계에 대한 정보를 얻을 수 있다.
주의할 점은 합성곱을 진행한다고 해서 DownSampling이 되는것은 아니다. 왜냐하면 픽셀이 가지고있는 값들은 계속해서 반영되고 있기 때문이다. 물론 합성곱 계층을 계속해서 지나면서 이미지의 크기가 1x1로 변하게되면 문제가 되는데 이는 Padding에서 다루도록 하겠다.



# 5. Feature extraction and convolution
<p align="center"><img src="https://user-images.githubusercontent.com/56510688/91635862-d3c10f80-ea36-11ea-863d-e54ec216ba6c.png"></p>
<p align="center">출처:<a href = "https://indoml.com/2018/03/07/student-notes-convolutional-neural-networks-cnn-introduction/">CNN INTRODUCTION</a></p>
바로 합성곱(Convolution)이 그 답이다. 합성곱 신경망은 입력 이미지에 대해 무작위로 초기화된 필터의 매개변수 값으로 합성곱을 수행하고 그 결과로 특징맵(Feature map)을 출력 결과로 내놓는다. 그리고 이 특징맵들은 활성화 함수(Activation function)을 거쳐 합성곱 신경망의 최종 출력인 활성화 맵(Activation map)을 내놓게 된다. 그리고 이 활성화 맵은 저수준(low-level)에서는 대부분 객체의 모서리(Edge)나 덩어리진 부분(Blob)을 보고있다.

- 필터의 계수는 입력 이미지의 채널 계수와 같다.
- 무작위로 초기화 하지 않으면 필터가 모두 같은 특징을 추출할 수 있다.

# 6. Convolution neural networks
<p align="center"><img src="https://user-images.githubusercontent.com/56510688/92123877-0fdde100-ee38-11ea-8d7d-627597b2df2f.jpeg"></p>


# 7. Non-linearity and pooling


# 8. Applications


# 9. End-to-end self Driving cars
